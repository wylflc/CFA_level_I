# 1 Quantitative Methods
## 1.1 Rates and Returns 利率与回报率
### 1.1.1 Interest Rates and Time Value of Money 利率和钱的时间价值
#### 利率(*r*)的三种解释方法：

1. required rates of return 要求的回报率：投资者在投资时所能接受的最低回报率。
2. discount rate 折扣率：即一年后的100元跟现在的100元肯定不是一回事，如果都是要给我100元，那每个人都会选择现在拿到而不是一年后拿到这100元。因此，这二者之间有一个折扣率存在。例如一年后的100元只能相当于现在的95元，则在这种换算关系下，利率为(100-95)/95 = 5.26%。
3.  opportunity costs 机会成本：投资者选择某个方案时所放弃的价值。在2的例子中，投资者如果现在现在的95元，则相当于放弃了一年后的100元，也就是放弃了一年5.26%的利率，因此，可以将5.26%视为投资者选择现在的95元所放弃的利率。
#### 利率的决定因素

_r_ = Real risk-free interest rate + Inflation premium + Default risk premium + Liquidity premium + Maturity premium.
**利率 = 实际无风险利率 + 通胀溢价 + 违约风险溢价 + 流动性溢价 + 期限溢价**

1. **实际无风险利率**是指在**完全无风险**的金融工具上的单期利率，假设**没有通胀预期**。在经济理论中，实际无风险利率反映了个体对于**当前消费与未来真实消费**的时间偏好（即人们愿意牺牲多少当前消费以换取未来消费）。
2. **通胀溢价**是投资者为**预期通胀**所要求的补偿，它反映了整个债务存续期内的**平均通胀预期**。通胀会削弱货币的购买力，也就是说，相同的货币单位未来能够购买的商品和服务数量减少，因此投资者要求额外的回报以弥补这一损失。
3. **违约风险溢价**是投资者为**借款人可能无法按合同约定的时间和金额履行还款义务**而要求的额外补偿。违约风险越高的债券，其利率中的违约溢价也越高，以吸引投资者承担风险。
4. **流动性溢价**是投资者为**快速变现可能导致的损失**而要求的额外补偿。例如，美国国债（T-bills）**没有流动性溢价**，因为它们市场交易活跃，大量买卖不会显著影响价格。而许多**小型企业发行的债券**在发行后交易频率很低，卖出这些债券可能需要更长时间或接受更低的价格，因此利率中包含流动性溢价，以补偿投资者面临的较高交易成本和价格冲击风险。
5. **期限溢价**是投资者为**长期债务市场价值对市场利率变动更敏感**而要求的额外补偿（在其他条件相同的情况下）。一般而言，长期债券的市场价格受利率变动的影响更大，因此投资者要求额外回报。例如，**长期美国国债的利率通常高于短期国债**，这种利差部分反映了期限溢价（同时可能还包含不同的通胀溢价）。

**名义无风险利率 = 实际无风险利率 + 通胀溢价**
1. (1 + nominal risk-free rate) = (1 + real risk-free rate)(1 + inflation premium)
	实际中，近似有：
	Nominal risk-free rate = Real risk-free rate + inflation premium
2. 许多国家都发行短期政府债务，其**利率可视为该国在相应期限内的名义无风险利率**。如法国政府的BTFs，日本政府的短期国库券，美国政府的90天国库券（T-bill）。
3. 利率中的风险溢价**会随时间变化**，**实际无风险利率也在不断波动**，因此**所有利率都会变动**。利率变动的幅度取决于各种**经济基本面（economic fundamentals）**，以及市场对**未来这些经济基本面的预期**。

#### 例题：**利率的确定**（Determining Interest Rates）

**图表 1** 展示了**五种债务证券的相关信息**。这五种投资工具的共同特点是：
- **仅在到期时进行一次性支付**（即零息债券或类似结构）。
- **假设通胀溢价（Inflation Premium）、流动性溢价（Liquidity Premium）和违约风险溢价（Default Risk Premium）在所有期限内保持不变**，即这些溢价不随债务期限变化。

![[Pasted image 20250312162423.png]]

1. 解释投资1和投资2之间的利率差异。
2. 估算影响所有证券的违约风险溢价。
3. 计算投资3的未知利率$r_3$的上下限

**答案**

1. 投资2相较于投资1，具有更差的流动性，因此存在一个流动性补偿利率，为0.5%。
2. 为了求风险溢价，应当比较risk栏分别为高和低的两个投资标的，即投资4和投资5，二者流动性和风险水平不同。因此为了确定风险溢价，需要先求出流动性溢价。从第一个问题中已知流动性补偿溢价为0.5%，而总利率差为2.5%，则可计算出违约风险溢价为2%。
3. 对于投资3，其到期时间界于2和4之间，则其上下限应给予2和4的数据得出。由于3和2的流动性以及风险水平均相同，则投资3的利率下限为投资2的利率，即2.5%；投资4利率为4%，考虑到流动性溢价为0.5%，其对应的低流动性标的的利率应为4.5%，则投资3的利率上限为4.5%。综上，$r_3$应当介于2.5%～4.5%之间。

***
### 1.1.2 Rates of Return 收益率

金融资产通常为投资者产生两种类型的回报。首先，它们可能通过**现金股息或利息支付**提供定期收入。其次，金融资产的**价格**可能会升高或降低，导致资本利得或损失。
#### Holding Period Return 持有期回报率
$$
R = \frac{P_1 - P_0 + I_1}{P_0}
$$
一般以年为单位进行计算，$P_1$对应第一年结束时的价格，$P_0$对应起始价格，$I_1$对应第一年的现金股息或利息支付等定期收入。
如果持有时间超过一年，例如三年的总回报率为
$$
R = (1+R_1)(1+R_2)(1+R_3) - 1
$$
其中$R_i$为第$i$年的回报率。
#### Arithmetic or Mean Return 算术平均回报（或平均回报）

多个收益率直接求平均值。
$$
\overline{R_i} = \frac{R_{i1} + R_{i2} + \cdots + R_{iT}}{T}
$$
这种简单的计算方法不能反映同一个资产随着时间的真实收益率，只能用来反映一些统计特征，或者用于计算同一时间段内，多个投资组合的平均收益率。
#### Geometric Mean Return 几何平均回报
$$
\overline{R_{iG}} = \left[\left(1+R_{i1}\right)\left(1+R_{i2}\right)\cdots\left(1+R_{iT}\right)\right]^{\frac{1}{T}} - 1
$$
几何平均值更能反映真实的收益率变化，表2比较了算数平均，几何平均，以及真实资产变化之间的关系。
![[Pasted image 20250317155657.png]]

对于连续三年收益率分别为-50%，35%，27%的投资组合，其真实收益如第3列所示；其算数平均为4%，对应倒数第二列的结果；几何平均值为-5%，对应最后一列的结果。
**几何平均值永远小于等于算数平均值。**
**几何平均回报**代表了投资的增长率或复合回报率。它衡量的是考虑复利效应后，投资在一定时期内的平均增长率，反映了资本的实际增长水平。
#### The Harmonic Mean 调和平均值
$$
\overline{X_H} = \frac{n}{\frac{1}{X_1}+\frac{1}{X_2}+\cdots+\frac{1}{X_n}}
$$
- **调和平均值**可以被视为一种特殊的加权平均，其可以排除极端值对平均值的影响，也就是降低极端值的权重。例如，1, 2, 3, 4, 5, 6, 1000的调和平均值为2.8560。
- 调和平均值在考虑公司的PE时，经常会被使用，例如一个公司联系三年的PE是45，15，15。其算数平均值为25，但是调和平均值为19.3。
- 一种常用的投资方式，**定投**，其**投资成本**便是所有定投日期股价的**调和平均值**。
##### 算数平均$\times$调和平均 = 几何平均$^2$
调和平均$\leq$几何平均$\leq$算数平均
#### 其他平均值
1. 修正平均值 trimmed mean：去掉一小部分极端值之后的平均值，例如，超过100的数据全部去掉。
2. winsorized mean：将极端值修正为一个设定的边界值之后的平均值，例如，超过100的数据全部按照100计算。

![[Pasted image 20250317161715.png]]

***
### 1.1.3 Money-Weighted and Time-Weighted Return 资金加权回报率和时间加权回报率

- 之前介绍的几种计算收益率的方法，都并不适合直接用于计算收益率，因为实际场景中，通常投资人的钱是分好几笔买入或者卖出的，而且每部分的钱持有的时间也可能不同，因此，需要引入资金加权回报率和时间加权回报率。
- 一般情况下，资金加权回报率更适合投资者计算自己投资的真实收益；而时间加权回报率更适合评估基金经理的水平。
#### 计算资金加权回报率

**Money-Weighted Return**（资金加权回报率）是基于投资者实际资金流入和流出的时间和金额来计算的回报率。它考虑了投资者在不同时间点进行的投资和提款，能够准确反映投资者的实际收益情况。
##### 计算方法：

MWR 可以通过求解以下等式来计算，它是投资现金流的内部收益率（IRR）：

$$
\sum_{t=1}^{n} \frac{C_t}{(1 + r)^{t}} = 0
$$
其中：

- \( $C_t$ \) 是在时间 \( $t$ \) 发生的现金流（包括投资或提取资金）。现金流可正可负，正指的是钱流向投资者，负指的是钱流出投资者。
- \( $r$ \) 是所需的回报率（即 MWR 需要解出的利率）。
- \( $n$ \) 是投资的时间段。

##### 特点：

- MWR 反映了投资者的实际回报，包括投资的时间和金额。
- MWR 对投资者现金流的时机敏感，特别适用于反映有现金流进出的投资，如定期存款或有多次追加投资的基金。

##### 例题：有分红情况下的资金加权回报率

考虑一个为期两年的投资。在时间$t = 0$时，投资者以**200 美元**的价格购买 **1 股**。在时间$t = 1$时，他以**225 美元**的价格额外购买 **1 股**。在第**2 年**末（$t = 2$），他以**235 美元**的价格卖出**两股**。在这两年内，该股票每年每股支付**5 美元**的股息。$t = 1$时收到的股息**未再投资**。Exhibit 11 列出了该投资的所有现金流入和流出情况。

![[Pasted image 20250318140926.png]]

**答案**

重要的是计算出每个时间点出入现金流，在$t=0$时刻，有200元流出投资者，$C_0=-200$；在$t=1$时刻，投资者又购买了一股，流出225元，同时受到分红5元，$C_1=-225+5=-220$；在$t=2$时刻，投资者卖出两股，收入$235\times 2=470$元，以及股息$5\times 2=10$元，$C_2 = 470+10=480$。因此，有
$$
\frac{C_0}{(1+IRR)^0} + \frac{C_1}{(1+IRR)^1} + \frac{C_2}{(1+IRR)^2} = 0
$$
$$
\frac{-200}{(1+IRR)^0} + \frac{-220}{(1+IRR)^1} + \frac{480}{(1+IRR)^2} = 0
$$
计算得到，$IRR=9.39\%$。
#### 时间加权回报率

- 一种不受资金追加和提取影响的投资衡量指标是**时间加权回报率（Time-Weighted Rate of Return, TWR）**。时间加权回报率衡量的是**最初投资 1 美元在投资组合中经过指定测量期后的复合增长率**。
- 在评估**公开交易证券的投资组合**时，时间加权回报率是首选的绩效衡量标准，因为它消除了资金**提取或追加**对回报率的影响，而这些资金流动通常**不受投资组合管理人的控制**。
##### 计算时间加权回报

要计算投资组合的**精确时间加权回报率（TWR）**，需执行以下三个步骤：

1. **在每次重要的资金流入或流出前，对投资组合进行定价**。根据资金流动的日期，将整体评估期划分为多个子周期。
2. **计算每个子周期的持有期回报率（Holding Period Return, HPR）**。
3. **将各子周期的持有期回报率相连或复利计算，以获得年度回报率**（即该年度的时间加权回报率）。如果投资周期超过一年，则取各年度回报率的**几何平均数**，以计算该测量期内的时间加权回报率。

例如在之前表11 的例子中，第一年，股价从200涨到了225，外加5元分红，则第一年收益率为$(225-200+5)/200 = 15\%$；第二年股价从225涨到了235，外加5元分红，则第二年收益率为$(235-225+5)/225 = 6.67\%$。则时间加权回报率为$[(1+0.15)(1+0.067)]^{\frac{1}{2}}-1=10.77\%$。

对比之前的资金加权回报率9.39%有所不同，这是因为第二年投入资金更多，因此资金回报率会给第二年的收益率更高权重，因此资金加权回报率要稍微低一些。

之前提到过计算时间加权回报时需要将时间划分为若干个子周期，实际应用中，一般以一天为周期进行计算更新。

#### 例题：
  ![[Pasted image 20250318151953.png]]

1. 计算In-House Account的时间加权回报率
2. 计算Super Trust Account的时间加权回报率

**答案**

1. 首先计算每个季度的回报率$R_i$，再计算全年回报率$(1+R_1)(1+R_2)(1+R_3)(1+R_4)-1$。结果为27.01%。
2. 计算方法类似，结果为26.02%。